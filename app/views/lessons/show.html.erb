<% if @lesson.reviews.length != 0 %>
<% rating_average = 0 %>
<% @lesson.reviews.each { |review| rating_average += review.rating} %>
<% rating_average = rating_average/@lesson.reviews.length %>
<% end %>

<h1 class="text-center"><%= @lesson.name %></h1>
<div class="container">
  <div class="row">
    <% user = "#{@lesson.user.first_name} #{@lesson.user.last_name}"%>
    <h3> Teacher: <%= link_to user, root_path %> </h3>
    <!-- change root path to user path  -->
    <div class="row">
      <button id="click" class="btn btn-primary btn-sm mb-3">
        Check profile
      </button>
    </div>
    <div class="row d-none user-info">
      <p>Based in <%= @lesson.user.location %> </p>
      <p>E-Mail: <%= @lesson.user.email %> </p>
      <p>Years of experience: <%= @lesson.user.years_of_exp %> </p>
      <h3>Languages: </h3>
      <% @lesson.user.languages.each do |language| %>
          <p><%= language.name %> </p>
        <% end %>
    </div>
    <p><%= @lesson.description %></p>
    <p>The hourly rate for this lesson is: <strong><u> <%= @lesson.price %>â‚¬ </u></strong></p>
    <p>Ratings (<%= @lesson.reviews.length %>): <%= rating_average ? rating_average : 'No ratings yet' %>/5 </p>

  </div>
</div>

<% if current_user.lessons.include? @lesson %>
  <%= link_to "Edit lesson", edit_lesson_path(@lesson) %>
<% else %>
  <div class="container">
    <div class="row">
    <h3>Book this session:</h3>
      <%= render 'form', lesson: @lesson, booking: @booking%>
    </div>
  </div>
<% end %>

<div class="container mt-3">
<h3>Reviews</h3>
<% @lesson.reviews.each do |review| %>
  <p>Rating: <%= review.rating %></p>
  <p>Comment: <%= review.comment %></p>
<% end %>
</div>